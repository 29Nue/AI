<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>üßÆ C√¥ng C·ª• T√≠nh To√°n Vui</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
    body {
        background: linear-gradient(to right, #f0f8ff, #ffe4e1);
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    .container-box {
        max-width: 900px;
        margin: 5vh auto;
        padding: 30px;
        background: white;
        border-radius: 20px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }
    h1 {
        font-weight: 700;
        text-align: center;
        margin-bottom: 30px;
    }
</style>
</head>
<body>

<div class="container-box">
    <h1>üßÆ C√¥ng C·ª• T√≠nh To√°n Vui</h1>

    <ul class="nav nav-tabs" id="calcTabs" role="tablist">
        <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#basicCalc">M√°y t√≠nh</a></li>
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#currency">Ngo·∫°i t·ªá</a></li>
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#bmi">BMI</a></li>
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#age">T√≠nh tu·ªïi</a></li>
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#unit">ƒê·ªïi ƒë∆°n v·ªã</a></li>
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#binary">Nh·ªã ph√¢n</a></li>
    </ul>

    <div class="tab-content mt-3">

      <!-- M√°y t√≠nh -->
    <div class="tab-pane fade show active" id="basicCalc">
    <div class="input-group mb-3">
        <input type="text" id="calcDisplay" class="form-control text-end fs-4" readonly placeholder="0">
    </div>

    <!-- H√†ng 7 8 9 / -->
    <div class="row g-2 mb-2">
        <div class="col-3"><button class="btn btn-light w-100" onclick="appendCalc('7')">7</button></div>
        <div class="col-3"><button class="btn btn-light w-100" onclick="appendCalc('8')">8</button></div>
        <div class="col-3"><button class="btn btn-light w-100" onclick="appendCalc('9')">9</button></div>
        <div class="col-3"><button class="btn btn-warning w-100" onclick="appendCalc('/')">√∑</button></div>
    </div>

    <!-- H√†ng 4 5 6 * -->
    <div class="row g-2 mb-2">
        <div class="col-3"><button class="btn btn-light w-100" onclick="appendCalc('4')">4</button></div>
        <div class="col-3"><button class="btn btn-light w-100" onclick="appendCalc('5')">5</button></div>
        <div class="col-3"><button class="btn btn-light w-100" onclick="appendCalc('6')">6</button></div>
        <div class="col-3"><button class="btn btn-warning w-100" onclick="appendCalc('*')">√ó</button></div>
    </div>

    <!-- H√†ng 1 2 3 - -->
    <div class="row g-2 mb-2">
        <div class="col-3"><button class="btn btn-light w-100" onclick="appendCalc('1')">1</button></div>
        <div class="col-3"><button class="btn btn-light w-100" onclick="appendCalc('2')">2</button></div>
        <div class="col-3"><button class="btn btn-light w-100" onclick="appendCalc('3')">3</button></div>
        <div class="col-3"><button class="btn btn-warning w-100" onclick="appendCalc('-')">‚àí</button></div>
    </div>

    <!-- H√†ng 0 = ‚å´ + -->
    <div class="row g-2 mb-2">
        <div class="col-3"><button class="btn btn-light w-100" onclick="appendCalc('0')">0</button></div>
        <div class="col-3"><button class="btn btn-success w-100" onclick="calculate()">=</button></div>
        <div class="col-3"><button class="btn btn-secondary w-100" onclick="backspaceCalc()">‚å´</button></div>
        <div class="col-3"><button class="btn btn-warning w-100" onclick="appendCalc('+')">+</button></div>
    </div>

    <!-- H√†ng ch·ª©c nƒÉng ƒë·∫∑c bi·ªát -->
    <div class="row g-2 mb-2">
        <div class="col-3"><button class="btn btn-danger w-100" onclick="clearCalc()">C</button></div>
        <div class="col-3"><button class="btn btn-info w-100" onclick="squareCalc()">x¬≤</button></div>
        <div class="col-3"><button class="btn btn-info w-100" onclick="cubeCalc()">x¬≥</button></div>
        <div class="col-3"><button class="btn btn-info w-100" onclick="powerCalc()">x ∏</button></div>
    </div>

    <!-- H√†ng cƒÉn b·∫≠c 2 v√† % -->
    <div class="row g-2">
        <div class="col-6"><button class="btn btn-info w-100" onclick="sqrtCalc()">‚àöx</button></div>
        <div class="col-6"><button class="btn btn-info w-100" onclick="percentCalc()">%</button></div>
    </div>
    </div>


       <!-- Ngo·∫°i t·ªá -->
        <div class="tab-pane fade" id="currency">
        <div class="mb-3">
            <input type="number" id="amount" class="form-control" placeholder="Nh·∫≠p s·ªë ti·ªÅn">
        </div>

        <div class="mb-3">
            <select id="currencySelect" class="form-select">
                <option value="usd">USD (1 USD = ...)</option>
                <option value="eur">EUR (1 EUR = ...)</option>
                <option value="jpy">JPY ‚Äì Y√™n Nh·∫≠t (1 JPY = ...)</option>
                <option value="krw">KRW ‚Äì Won H√†n (1 KRW = ...)</option>
                <option value="cny">CNY ‚Äì Nh√¢n d√¢n t·ªá Trung (1 CNY = ...)</option>
                <option value="thb">THB ‚Äì Baht Th√°i (1 THB = ...)</option>
                <option value="inr">INR ‚Äì Rupee ·∫§n (1 INR = ...)</option>
            </select>
        </div>

        <div class="mb-3">
            <select id="directionSelect" class="form-select">
                <option value="vnd_to_foreign">VNƒê ‚û° Ngo·∫°i t·ªá</option>
                <option value="foreign_to_vnd">Ngo·∫°i t·ªá ‚û° VNƒê</option>
            </select>
        </div>

        <button class="btn btn-primary" onclick="convertCurrency()">Chuy·ªÉn ƒë·ªïi</button>
        <p class="mt-3 fw-bold" id="currencyResult"></p>
        <small id="lastUpdate" class="text-muted"></small>
    </div>

        <!-- BMI -->
        <div class="tab-pane fade" id="bmi">
            <input type="number" id="height" class="form-control mb-2" placeholder="Chi·ªÅu cao (cm)">
            <input type="number" id="weight" class="form-control mb-2" placeholder="C√¢n n·∫∑ng (kg)">
            <button class="btn btn-primary" onclick="calcBMI()">T√≠nh BMI</button>
            <p class="mt-3 fw-bold" id="bmiResult"></p>
        </div>

        <!-- T√≠nh tu·ªïi -->
        <div class="tab-pane fade" id="age">
            <input type="date" id="birthDate" class="form-control mb-2">
            <button class="btn btn-primary" onclick="calcAge()">T√≠nh tu·ªïi</button>
            <p class="mt-3 fw-bold" id="ageResult"></p>
        </div>

        <!-- ƒê·ªïi ƒë∆°n v·ªã -->
<div class="tab-pane fade" id="unit">
    <div class="container py-3">
        
        <!-- Chi·ªÅu d√†i -->
        <div class="card mb-4 shadow-sm">
            <div class="card-body">
                <h5 class="card-title">üìè Chi·ªÅu d√†i</h5>
                <div class="row g-2 align-items-center">
                    <div class="col-md-4">
                        <input type="number" id="meter" class="form-control" placeholder="Nh·∫≠p m√©t">
                    </div>
                    <div class="col-md-8 d-flex gap-2">
                        <button class="btn btn-outline-primary" onclick="mToCm()">‚Üí cm</button>
                        <button class="btn btn-outline-primary" onclick="mToInch()">‚Üí inch</button>
                    </div>
                </div>
                <p class="mt-2 fw-bold text-success" id="unitLength"></p>
            </div>
        </div>

        <!-- C√¢n n·∫∑ng -->
        <div class="card mb-4 shadow-sm">
            <div class="card-body">
                <h5 class="card-title">‚öñ C√¢n n·∫∑ng</h5>
                <div class="row g-2 align-items-center">
                    <div class="col-md-4">
                        <input type="number" id="kg" class="form-control" placeholder="Nh·∫≠p kg">
                    </div>
                    <div class="col-md-8 d-flex gap-2">
                        <button class="btn btn-outline-warning" onclick="kgToGram()">‚Üí g</button>
                        <button class="btn btn-outline-warning" onclick="kgToLb()">‚Üí lb</button>
                    </div>
                </div>
                <p class="mt-2 fw-bold text-success" id="unitWeight"></p>
            </div>
        </div>

        <!-- Nhi·ªát ƒë·ªô -->
        <div class="card mb-4 shadow-sm">
            <div class="card-body">
                <h5 class="card-title">üå° Nhi·ªát ƒë·ªô</h5>
                <div class="row g-2 align-items-center">
                    <div class="col-md-4">
                        <input type="number" id="celsius" class="form-control" placeholder="Nh·∫≠p ¬∞C">
                    </div>
                    <div class="col-md-8 d-flex gap-2">
                        <button class="btn btn-outline-danger" onclick="cToF()">‚Üí ¬∞F</button>
                        <button class="btn btn-outline-danger" onclick="cToK()">‚Üí K</button>
                    </div>
                </div>
                <p class="mt-2 fw-bold text-success" id="unitTemp"></p>
            </div>
        </div>
    </div>
</div>
 <!-- Nh·ªã ph√¢n -->
        <div class="tab-pane fade" id="binary">
            <div class="mb-3">
                <input type="text" id="binInput" class="form-control" placeholder="Nh·∫≠p s·ªë nh·ªã ph√¢n (v√≠ d·ª•: 1011)">
                <button class="btn btn-primary mt-2" onclick="binToDec()">‚Üí Th·∫≠p ph√¢n</button>
                <p class="fw-bold mt-2 text-success" id="binToDecResult"></p>
            </div>

            <div class="mb-3">
                <input type="number" id="decInput" class="form-control" placeholder="Nh·∫≠p s·ªë th·∫≠p ph√¢n (v√≠ d·ª•: 13)">
                <button class="btn btn-primary mt-2" onclick="decToBin()">‚Üí Nh·ªã ph√¢n</button>
                <p class="fw-bold mt-2 text-success" id="decToBinResult"></p>
            </div>

            <div class="mb-3">
                <input type="text" id="binExpr" class="form-control" placeholder="Nh·∫≠p bi·ªÉu th·ª©c nh·ªã ph√¢n(+,-,*,/).(v√≠ d·ª•: 101+11)">
                <button class="btn btn-warning mt-2" onclick="calcBinary()">T√≠nh to√°n</button>
                <p class="fw-bold mt-2 text-success" id="binCalcResult"></p>
            </div>
        </div>
         <a href="/" class="btn btn-outline-secondary mt-3">&larr; Quay l·∫°i trang ch·ªß</a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // M√°y t√≠nh
   let calcDisplay = document.getElementById('calcDisplay');
    let currentExpression = '';
    let waitingForPower = false;

    function appendCalc(value) {
    if (waitingForPower && !isNaN(value)) {
        currentExpression += `**${value}`;
        waitingForPower = false;
    } else {
        currentExpression += value;
    }
    calcDisplay.value = currentExpression;
    }

    function clearCalc() {
    currentExpression = '';
    calcDisplay.value = '';
    }

    function backspaceCalc() {
    currentExpression = currentExpression.slice(0, -1);
    calcDisplay.value = currentExpression;
    }

    function calculate() {
    try {
        let result = eval(currentExpression);
        if (result === Infinity || isNaN(result)) {
        calcDisplay.value = 'L·ªói üò¢';
        } else {
        calcDisplay.value = result;
        currentExpression = result.toString();
        }
    } catch {
        calcDisplay.value = 'L·ªói üò¢';
    }
    }

    // x¬≤
    function squareCalc() {
    try {
        let value = parseFloat(currentExpression || calcDisplay.value);
        if (!isNaN(value)) {
        let result = Math.pow(value, 2);
        calcDisplay.value = result;
        currentExpression = result.toString();
        }
    } catch {
        calcDisplay.value = 'L·ªói üò¢';
    }
    }

    // x¬≥
    function cubeCalc() {
    try {
        let value = parseFloat(currentExpression || calcDisplay.value);
        if (!isNaN(value)) {
        let result = Math.pow(value, 3);
        calcDisplay.value = result;
        currentExpression = result.toString();
        }
    } catch {
        calcDisplay.value = 'L·ªói üò¢';
    }
    }

    // x ∏
    function powerCalc() {
    waitingForPower = true;
    calcDisplay.value = currentExpression + '^';
    }

    // ‚àöx
    function sqrtCalc() {
    try {
        let value = parseFloat(currentExpression || calcDisplay.value);
        if (!isNaN(value)) {
        let result = Math.sqrt(value);
        calcDisplay.value = result;
        currentExpression = result.toString();
        }
    } catch {
        calcDisplay.value = 'L·ªói üò¢';
    }
    }

    // %
    function percentCalc() {
    try {
        let value = parseFloat(currentExpression || calcDisplay.value);
        if (!isNaN(value)) {
        let result = value / 100;
        calcDisplay.value = result;
        currentExpression = result.toString();
        }
    } catch {
        calcDisplay.value = 'L·ªói üò¢';
    }
    }


    // Ngo·∫°i t·ªá
    const defaultRates = {
        USD: 26225,
        EUR: 30531,
        JPY: 173.61,
        KRW: 18.15,
        CNY: 3594,
        THB: 794.75,
        INR: 297.67,
        };
        let rates = { ...defaultRates };

        async function fetchRates() {
        const API_URL = "https://open.er-api.com/v6/latest/VND";
        try {
            const res = await fetch(API_URL);
            if (!res.ok) throw new Error("HTTP " + res.status);
            const data = await res.json();

            if (data && data.result === "success") {
            for (let key in defaultRates) {
                if (data.rates[key]) {
                rates[key] = 1 / data.rates[key]; // V√¨ base l√† VND, ta ƒë·∫£o l·∫°i
                }
            }
            updateSelectOptions();
            updateLastUpdate(true, data.time_last_update_utc);
            } else {
            updateLastUpdate(false);
            }
        } catch (err) {
            console.warn("Kh√¥ng th·ªÉ l·∫•y t·ª∑ gi√°:", err);
            updateLastUpdate(false);
        }
        }

        function updateSelectOptions() {
        const currencyMap = {
            USD: "USD",
            EUR: "EUR",
            JPY: "JPY ‚Äì Y√™n Nh·∫≠t",
            KRW: "KRW ‚Äì Won H√†n",
            CNY: "CNY ‚Äì Nh√¢n d√¢n t·ªá Trung",
            THB: "THB ‚Äì Baht Th√°i",
            INR: "INR ‚Äì Rupee ·∫§n",
        };

        for (let key in currencyMap) {
            const opt = document.querySelector(`#currencySelect option[value="${key.toLowerCase()}"]`);
            if (opt) {
            const formatted = rates[key].toLocaleString("vi-VN", { maximumFractionDigits: 2 });
            opt.textContent = `${currencyMap[key]} (1 ${key} = ${formatted} VND)`;
            }
        }
        }

        function updateLastUpdate(success, time = null) {
        const el = document.getElementById("lastUpdate");
        if (success) {
            el.innerText = `üîÅ T·ª∑ gi√° c·∫≠p nh·∫≠t: ${new Date(time).toLocaleString("vi-VN")}`;
        } else {
            el.innerText = `‚ö†Ô∏è Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t t·ª∑ gi√° (hi·ªÉn th·ªã d·ªØ li·ªáu m·∫∑c ƒë·ªãnh)`;
        }
        }

        function convertCurrency() {
        const amount = parseFloat(document.getElementById("amount").value);
        const currency = document.getElementById("currencySelect").value.toUpperCase();
        const direction = document.getElementById("directionSelect").value;
        const resultEl = document.getElementById("currencyResult");

        if (isNaN(amount) || amount <= 0) {
            resultEl.innerText = "‚ö†Ô∏è Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn h·ª£p l·ªá.";
            return;
        }

        if (!rates[currency]) {
            resultEl.innerText = "‚ùå Kh√¥ng c√≥ t·ª∑ gi√° cho " + currency;
            return;
        }

        let result;
        if (direction === "vnd_to_foreign") {
            result = (amount / rates[currency]).toFixed(2) + " " + currency;
        } else {
            result = (amount * rates[currency]).toLocaleString("vi-VN") + " VNƒê";
        }

        resultEl.innerText = "üí± K·∫øt qu·∫£: " + result;
        }

        // Ch·∫°y khi m·ªü trang
        updateSelectOptions();
        fetchRates();

    // BMI
    function calcBMI() {
        let h = parseFloat(document.getElementById('height').value) / 100;
        let w = parseFloat(document.getElementById('weight').value);
        if (isNaN(h) || isNaN(w) || h <= 0) return alert('Nh·∫≠p d·ªØ li·ªáu h·ª£p l·ªá');
        let bmi = (w / (h*h)).toFixed(1);
        let status = bmi < 18.5 ? 'G·∫ßy' : bmi < 25 ? 'B√¨nh th∆∞·ªùng' : bmi < 30 ? 'Th·ª´a c√¢n' : 'B√©o ph√¨';
        document.getElementById('bmiResult').innerText = `BMI: ${bmi} (${status})`;
    }

    // T√≠nh tu·ªïi
    function calcAge() {
        let birth = new Date(document.getElementById('birthDate').value);
        if (!birth.getTime()) return alert('Ch·ªçn ng√†y sinh');
        let age = new Date().getFullYear() - birth.getFullYear();
        document.getElementById('ageResult').innerText = `Tu·ªïi: ${age}`;
    }

    // ƒê·ªïi ƒë∆°n v·ªã
    function mToCm() {
        let m = parseFloat(document.getElementById('meter').value);
        if (isNaN(m)) return alert('Nh·∫≠p s·ªë m√©t');
        document.getElementById('unitLength').innerText = `${m} m = ${m*100} cm`;
    }
    function mToInch() {
        let m = parseFloat(document.getElementById('meter').value);
        if (isNaN(m)) return alert('Nh·∫≠p s·ªë m√©t');
        document.getElementById('unitLength').innerText = `${m} m = ${(m*39.3701).toFixed(2)} inch`;
    }
    function kgToGram() {
        let kg = parseFloat(document.getElementById('kg').value);
        if (isNaN(kg)) return alert('Nh·∫≠p s·ªë kg');
        document.getElementById('unitWeight').innerText = `${kg} kg = ${kg*1000} g`;
    }
    function kgToLb() {
        let kg = parseFloat(document.getElementById('kg').value);
        if (isNaN(kg)) return alert('Nh·∫≠p s·ªë kg');
        document.getElementById('unitWeight').innerText = `${kg} kg = ${(kg*2.20462).toFixed(2)} lb`;
    }
    function cToF() {
        let c = parseFloat(document.getElementById('celsius').value);
        if (isNaN(c)) return alert('Nh·∫≠p nhi·ªát ƒë·ªô');
        document.getElementById('unitTemp').innerText = `${c}¬∞C = ${(c*9/5+32).toFixed(1)}¬∞F`;
    }
    function cToK() {
        let c = parseFloat(document.getElementById('celsius').value);
        if (isNaN(c)) return alert('Nh·∫≠p nhi·ªát ƒë·ªô');
        document.getElementById('unitTemp').innerText = `${c}¬∞C = ${(c+273.15).toFixed(2)} K`;
    }

    // Chuy·ªÉn nh·ªã ph√¢n sang th·∫≠p ph√¢n
    function binToDec() {
        let bin = document.getElementById("binInput").value;
        if (!/^[01]+$/.test(bin)) return alert("Vui l√≤ng nh·∫≠p s·ªë nh·ªã ph√¢n h·ª£p l·ªá");
        document.getElementById("binToDecResult").innerText = `${bin} (2) = ${parseInt(bin, 2)} (10)`;
    }

    // Chuy·ªÉn th·∫≠p ph√¢n sang nh·ªã ph√¢n
    function decToBin() {
        let dec = parseInt(document.getElementById("decInput").value);
        if (isNaN(dec)) return alert("Nh·∫≠p s·ªë th·∫≠p ph√¢n h·ª£p l·ªá");
        document.getElementById("decToBinResult").innerText = `${dec} (10) = ${dec.toString(2)} (2)`;
    }

    // T√≠nh to√°n nh·ªã ph√¢n (+ - * /)
    function calcBinary() {
        let expr = document.getElementById("binExpr").value;
        if (!expr) return alert("Nh·∫≠p bi·ªÉu th·ª©c nh·ªã ph√¢n");

        try {
            // T√°ch to√°n h·∫°ng v√† to√°n t·ª≠
            let match = expr.match(/^([01]+)([\+\-\*\/])([01]+)$/);
            if (!match) return alert("Bi·ªÉu th·ª©c kh√¥ng h·ª£p l·ªá. V√≠ d·ª•: 101+11");

            let a = parseInt(match[1], 2);
            let op = match[2];
            let b = parseInt(match[3], 2);

            let res;
            switch(op) {
                case "+": res = a + b; break;
                case "-": res = a - b; break;
                case "*": res = a * b; break;
                case "/": 
                    if (b === 0) return alert("Kh√¥ng th·ªÉ chia cho 0");
                    res = Math.floor(a / b); 
                    break;
            }

            document.getElementById("binCalcResult").innerText = 
                `${expr} = ${res.toString(2)} (2) = ${res} (10)`;

        } catch {
            alert("C√≥ l·ªói khi t√≠nh to√°n");
        }
    }
 </script>
</body>
</html>